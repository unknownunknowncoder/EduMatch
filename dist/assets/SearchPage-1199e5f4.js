import{c as x,d as K,u as Q,r as n,p as b,q as Z,s as J,x as W,a as c,b as a,e as d,f as g,i as u,v as f,y as X,l as L,F as O,z as T,A as m,B as Y,j as ee,o as y,n as _,t as S,_ as te}from"./index-7612b546.js";import{useDatabaseStore as E}from"./database-ff9128f9.js";import{S as I}from"./search-d21746b3.js";import{C as re}from"./clock-aad734ed.js";import"./supabase-f74fb3ee.js";/**
 * @license lucide-vue-next v0.420.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=x("ArrowLeftIcon",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-vue-next v0.420.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=x("FileTextIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-vue-next v0.420.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=x("FilterIcon",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-vue-next v0.420.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=x("TargetIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),ne={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},ie={class:"bg-white/80 dark:bg-gray-800/80 backdrop-blur-md shadow-sm sticky top-0 z-50"},ue={class:"container mx-auto px-4 py-4"},de={class:"flex items-center space-x-4"},ge={class:"flex-1 relative"},pe={class:"mt-4 border-t border-gray-200 dark:border-gray-700 pt-4"},ce={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},ye={class:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700"},ve={class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center"},be={class:"flex flex-wrap gap-2 mb-3"},fe=["onClick"],me={class:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700"},xe={class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center"},ke={class:"flex flex-wrap gap-2 mb-3"},he=["onClick"],we={class:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700"},Ce={class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center"},Le={class:"flex flex-wrap gap-2 mb-3"},Oe=["onClick"],Te={key:0,class:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4"},_e={class:"container mx-auto px-4 py-6"},Se={class:"flex flex-col items-center justify-center py-16 text-center"},Ge=K({__name:"SearchPage",setup(Ve){const U=Q(),i=n(""),G=n(!1),k=n(!1),V=n(!1),s=n({type:"",difficulty:"",duration:"",rating:""}),z=[{label:"掌握基础",value:"basic"},{label:"进阶提升",value:"intermediate"},{label:"专家级别",value:"advanced"}],A=[{label:"1小时以内",value:"short"},{label:"1-3小时",value:"medium"},{label:"3小时以上",value:"long"}],B=[{label:"视频课程",value:"video-course"},{label:"图文教程",value:"tutorial"},{label:"实践项目",value:"practice"}],l=n({learningGoal:"",learningGoalOptions:[],duration:"",durationOptions:[],resourceType:"",resourceTypeOptions:[]}),F=n("relevance"),v=n(1),h=n(9),M=n([]),w=n([]),P=async()=>{try{const e=await E().getResources({limit:10}),t=new Set;e.forEach(o=>{o.title&&o.title.split(" ").forEach(p=>{p.length>1&&t.add(p)})}),M.value=Array.from(t).slice(0,7)}catch(r){console.warn("加载搜索建议失败:",r),M.value=[]}},$=async r=>{G.value=!0;try{const t=await E().searchResources(r);return w.value=t,t}catch(e){return console.error("搜索失败:",e),w.value=[],[]}finally{G.value=!1}},q=r=>{const e=l.value.learningGoalOptions.indexOf(r);e>-1?l.value.learningGoalOptions.splice(e,1):l.value.learningGoalOptions.push(r)},H=r=>{const e=l.value.durationOptions.indexOf(r);e>-1?l.value.durationOptions.splice(e,1):l.value.durationOptions.push(r)},N=r=>{const e=l.value.resourceTypeOptions.indexOf(r);e>-1?l.value.resourceTypeOptions.splice(e,1):l.value.resourceTypeOptions.push(r)},R=async()=>{!i.value.trim()&&!l.value.learningGoal.trim()&&!l.value.resourceType.trim()&&!l.value.duration.trim()&&l.value.learningGoalOptions.length===0&&l.value.durationOptions.length===0&&l.value.resourceTypeOptions.length===0||(v.value=1,V.value=!0,await $(i.value))},D=b(()=>{if(!V.value)return[];let r=[...w.value];if(i.value&&(r=r.filter(e=>e.title.toLowerCase().includes(i.value.toLowerCase())||e.description.toLowerCase().includes(i.value.toLowerCase())||e.tags.some(t=>t.toLowerCase().includes(i.value.toLowerCase())))),l.value.learningGoalOptions.length>0&&(r=r.filter(e=>l.value.learningGoalOptions.some(t=>{const o=t.toLowerCase();return e.title.toLowerCase().includes(o)||e.description.toLowerCase().includes(o)||e.tags.some(p=>p.toLowerCase().includes(o))}))),l.value.durationOptions.length>0&&(r=r.filter(e=>l.value.durationOptions.some(t=>{const o=t.toLowerCase();return o==="short"?e.duration==="short":o==="medium"?e.duration==="medium":o==="long"?e.duration==="long":e.duration.toLowerCase().includes(o)}))),l.value.resourceTypeOptions.length>0&&(r=r.filter(e=>l.value.resourceTypeOptions.some(t=>{const o=t.toLowerCase();return o==="video-course"?e.type==="video"||e.type==="course":o==="tutorial"?e.type==="article"||e.type==="tutorial":o==="practice"?e.type==="practice"||e.type==="project"||e.title.toLowerCase().includes("project")||e.title.toLowerCase().includes("practice"):e.type.toLowerCase().includes(o)||e.tags.some(p=>p.toLowerCase().includes(o))}))),l.value.learningGoal){const e=l.value.learningGoal.toLowerCase();r=r.filter(t=>t.title.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)||t.tags.some(o=>o.toLowerCase().includes(e)))}if(l.value.resourceType){const e=l.value.resourceType.toLowerCase();r=r.filter(t=>t.type.toLowerCase().includes(e)||t.category.toLowerCase().includes(e)||t.tags.some(o=>o.toLowerCase().includes(e)))}if(l.value.duration){const e=l.value.duration.toLowerCase();r=r.filter(t=>t.duration.toLowerCase().includes(e))}if(s.value.type&&(r=r.filter(e=>e.type===s.value.type)),s.value.difficulty&&(r=r.filter(e=>e.difficulty===s.value.difficulty)),s.value.duration&&(r=r.filter(e=>e.duration===s.value.duration)),s.value.rating){const e=parseFloat(s.value.rating);r=r.filter(t=>t.rating>=e)}switch(F.value){case"rating":r.sort((e,t)=>t.rating-e.rating);break;case"date":r.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime());break;case"views":r.sort((e,t)=>t.views-e.views);break}return r}),j=b(()=>Math.ceil(D.value.length/h.value));b(()=>{const r=(v.value-1)*h.value,e=r+h.value;return D.value.slice(r,e)}),b(()=>{const r=[],e=j.value,t=v.value;if(e<=7)for(let o=1;o<=e;o++)r.push(o);else if(t<=4){for(let o=1;o<=5;o++)r.push(o);r.push("..."),r.push(e)}else if(t>=e-3){r.push(1),r.push("...");for(let o=e-4;o<=e;o++)r.push(o)}else{r.push(1),r.push("...");for(let o=t-1;o<=t+1;o++)r.push(o);r.push("..."),r.push(e)}return r}),Z([s,F],()=>{v.value=1});const C=n(null);return J(()=>{P();const r=U.currentRoute.value.query.q;r&&typeof r=="string"&&(i.value=r),W(()=>{C.value&&C.value.focus()})}),(r,e)=>(y(),c("div",ne,[a("header",ie,[a("div",ue,[a("div",de,[a("button",{onClick:e[0]||(e[0]=t=>r.$router.back()),class:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"},[d(g(ae),{class:"h-5 w-5"})]),a("div",ge,[d(g(I),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u(a("input",{ref_key:"searchInput",ref:C,"onUpdate:modelValue":e[1]||(e[1]=t=>i.value=t),onKeyup:X(R,["enter"]),type:"text",placeholder:"搜索学习资源...",class:"w-full pl-10 pr-24 py-3 bg-gray-100 dark:bg-gray-700 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"},null,544),[[f,i.value]]),a("button",{onClick:R,class:"absolute right-2 top-1/2 transform -translate-y-1/2 px-4 py-1.5 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-full transition-colors"}," 搜索 ")]),a("button",{onClick:e[2]||(e[2]=t=>k.value=!k.value),class:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"},[d(g(le),{class:"h-5 w-5"})])]),a("div",pe,[a("div",ce,[a("div",ye,[a("h4",ve,[d(g(se),{class:"h-4 w-4 mr-2 text-blue-500"}),e[10]||(e[10]=L(" 学习目标 ",-1))]),a("div",be,[(y(),c(O,null,T(z,t=>a("button",{key:t.value,onClick:o=>q(t.value),class:_(["px-3 py-1.5 text-sm rounded-lg border transition-all duration-200",l.value.learningGoalOptions.includes(t.value)?"bg-blue-50 dark:bg-blue-900/20 border-blue-500 text-blue-700 dark:text-blue-300":"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:border-gray-400 dark:hover:border-gray-500"])},S(t.label),11,fe)),64))]),u(a("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>l.value.learningGoal=t),type:"text",placeholder:"例如：掌握React基础",class:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"},null,512),[[f,l.value.learningGoal]])]),a("div",me,[a("h4",xe,[d(g(re),{class:"h-4 w-4 mr-2 text-green-500"}),e[11]||(e[11]=L(" 资源时长 ",-1))]),a("div",ke,[(y(),c(O,null,T(A,t=>a("button",{key:t.value,onClick:o=>H(t.value),class:_(["px-3 py-1.5 text-sm rounded-lg border transition-all duration-200",l.value.durationOptions.includes(t.value)?"bg-green-50 dark:bg-green-900/20 border-green-500 text-green-700 dark:text-green-300":"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:border-gray-400 dark:hover:border-gray-500"])},S(t.label),11,he)),64))]),u(a("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>l.value.duration=t),type:"text",placeholder:"例如：1-2小时",class:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"},null,512),[[f,l.value.duration]])]),a("div",we,[a("h4",Ce,[d(g(oe),{class:"h-4 w-4 mr-2 text-purple-500"}),e[12]||(e[12]=L(" 资源类型 ",-1))]),a("div",Le,[(y(),c(O,null,T(B,t=>a("button",{key:t.value,onClick:o=>N(t.value),class:_(["px-3 py-1.5 text-sm rounded-lg border transition-all duration-200",l.value.resourceTypeOptions.includes(t.value)?"bg-purple-50 dark:bg-purple-900/20 border-purple-500 text-purple-700 dark:text-purple-300":"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:border-gray-400 dark:hover:border-gray-500"])},S(t.label),11,Oe)),64))]),u(a("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>l.value.resourceType=t),type:"text",placeholder:"例如：视频课程",class:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"},null,512),[[f,l.value.resourceType]])])])]),k.value?(y(),c("div",Te,[a("div",null,[e[14]||(e[14]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"类型",-1)),u(a("select",{"onUpdate:modelValue":e[6]||(e[6]=t=>s.value.type=t),class:"w-full bg-gray-100 dark:bg-gray-700 border-0 rounded-lg px-3 py-2 text-sm"},[...e[13]||(e[13]=[Y('<option value="" data-v-4d270a57>全部</option><option value="course" data-v-4d270a57>课程</option><option value="video" data-v-4d270a57>视频</option><option value="article" data-v-4d270a57>文章</option><option value="book" data-v-4d270a57>书籍</option><option value="tool" data-v-4d270a57>工具</option>',6)])],512),[[m,s.value.type]])]),a("div",null,[e[16]||(e[16]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"难度",-1)),u(a("select",{"onUpdate:modelValue":e[7]||(e[7]=t=>s.value.difficulty=t),class:"w-full bg-gray-100 dark:bg-gray-700 border-0 rounded-lg px-3 py-2 text-sm"},[...e[15]||(e[15]=[a("option",{value:""},"全部",-1),a("option",{value:"beginner"},"初级",-1),a("option",{value:"intermediate"},"中级",-1),a("option",{value:"advanced"},"高级",-1)])],512),[[m,s.value.difficulty]])]),a("div",null,[e[18]||(e[18]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"时长",-1)),u(a("select",{"onUpdate:modelValue":e[8]||(e[8]=t=>s.value.duration=t),class:"w-full bg-gray-100 dark:bg-gray-700 border-0 rounded-lg px-3 py-2 text-sm"},[...e[17]||(e[17]=[a("option",{value:""},"全部",-1),a("option",{value:"short"},"短篇 (< 30分钟)",-1),a("option",{value:"medium"},"中等 (30分钟-2小时)",-1),a("option",{value:"long"},"长篇 (> 2小时)",-1)])],512),[[m,s.value.duration]])]),a("div",null,[e[20]||(e[20]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"评分",-1)),u(a("select",{"onUpdate:modelValue":e[9]||(e[9]=t=>s.value.rating=t),class:"w-full bg-gray-100 dark:bg-gray-700 border-0 rounded-lg px-3 py-2 text-sm"},[...e[19]||(e[19]=[a("option",{value:""},"全部",-1),a("option",{value:"4.5"},"4.5星以上",-1),a("option",{value:"4.0"},"4.0星以上",-1),a("option",{value:"3.5"},"3.5星以上",-1)])],512),[[m,s.value.rating]])])])):ee("",!0)])]),a("main",_e,[a("div",Se,[d(g(I),{class:"h-16 w-16 text-gray-300 dark:text-gray-600 mb-4"}),e[21]||(e[21]=a("h3",{class:"text-lg font-semibold text-gray-600 dark:text-gray-400 mb-2"}," 搜索学习资源 ",-1)),e[22]||(e[22]=a("p",{class:"text-gray-500 dark:text-gray-500"}," 输入关键词或选择筛选条件，然后点击搜索按钮 ",-1))])])]))}});const Ie=te(Ge,[["__scopeId","data-v-4d270a57"],["__file","E:/前端初级课程/program/EduMatch/src/views/SearchPage.vue"]]);export{Ie as default};
