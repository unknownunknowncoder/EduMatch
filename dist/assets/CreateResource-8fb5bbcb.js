import{d as v,u as w,r as h,g as C,a as c,B as b,b as t,w as S,l as n,i as a,v as i,A as m,j as V,t as U,o as y,_ as B}from"./index-7612b546.js";import{supabaseService as x}from"./supabase-f74fb3ee.js";const D={class:"p-6 md:p-8"},E={class:"max-w-4xl mx-auto"},M={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6"},R={class:"mb-8"},j={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},A={class:"mt-6"},I={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-6"},N={class:"mb-8"},q={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},z={class:"flex justify-end space-x-4"},F=["disabled"],H={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},J=v({__name:"CreateResource",setup(L){const g=w(),d=h(!1),r=C({title:"",type:"",description:"",duration:"",difficulty:"intermediate",tags:"",url:"",provider:""}),f=async()=>{d.value=!0;try{let s=null;if(typeof window<"u"){const l=localStorage.getItem("currentUser");if(l){const u=JSON.parse(l);u&&u.id&&(s=u.id,console.log("ä½¿ç”¨å½“å‰ç™»å½•ç”¨æˆ·ID:",s))}}if(!s){alert("è¯·å…ˆç™»å½•åå†å‘å¸ƒèµ„æº"),d.value=!1;return}const e={title:r.title,description:r.description,type:r.type||"other",category:r.type,difficulty:r.difficulty,duration:r.duration,provider:r.provider,url:r.url,tags:r.tags?r.tags.split(",").map(l=>l.trim()):[],created_by:s};console.log("æäº¤èµ„æºæ•°æ®:",e);const o=await x.createResource(e);if(console.log("âœ… èµ„æºåˆ›å»ºæˆåŠŸ:",o),console.log("ğŸ“Š èµ„æºID:",o.id),!o||!o.id)throw new Error("èµ„æºåˆ›å»ºå¤±è´¥ï¼šè¿”å›æ•°æ®æ— æ•ˆ");const p={user_id:s,title:r.title,content:r.description||"åˆ†äº«äº†ä¸€ä¸ªå­¦ä¹ èµ„æº",category:r.type||"other",likes_count:0,views_count:0};try{console.log("ğŸ”„ å‡†å¤‡åˆ›å»ºç¤¾åŒºå¸–å­ï¼Œæ•°æ®:",p);const l=await x.createCommunityPost(p);console.log("âœ… ç¤¾åŒºå¸–å­åˆ›å»ºæˆåŠŸ:",l),console.log("ğŸ“Š å¸–å­ID:",l.id),console.log("ğŸ“Š å¸–å­æ ‡é¢˜:",l.title),alert("å‘å¸ƒæˆåŠŸï¼èµ„æºå·²æ·»åŠ åˆ°å­¦ä¹ ç¤¾åŒº")}catch(l){console.error("âŒ åˆ›å»ºç¤¾åŒºå¸–å­å¤±è´¥:",l),console.error("âŒ é”™è¯¯è¯¦æƒ…:",l.message),console.error("âŒ é”™è¯¯ä»£ç :",l.code),l.code==="42501"||l.message.includes("row-level security policy")?alert(`å‘å¸ƒæˆåŠŸï¼ä½†ç”±äºæ•°æ®åº“å®‰å…¨ç­–ç•¥ï¼Œèµ„æºæš‚æ—¶æ— æ³•æ˜¾ç¤ºåœ¨å­¦ä¹ ç¤¾åŒºä¸­ã€‚

è¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
1. æ‰“å¼€ Supabase SQL Editor
2. æ‰§è¡Œ fix-community-posts-rls.sql æ–‡ä»¶ä¸­çš„SQLè¯­å¥
3. é‡æ–°å‘å¸ƒèµ„æº`):alert("èµ„æºå‘å¸ƒæˆåŠŸï¼ä½†æœªèƒ½æ·»åŠ åˆ°å­¦ä¹ ç¤¾åŒºï¼Œè¯·ç¨åæ‰‹åŠ¨åˆ†äº«")}g.push("/")}catch(s){console.error("æäº¤å¤±è´¥:",s),alert("èµ„æºåˆ›å»ºå¤±è´¥ï¼Œè¯·é‡è¯•: "+s.message)}finally{d.value=!1}},k=()=>{g.push("/search")};return(s,e)=>(y(),c("div",D,[e[21]||(e[21]=b('<div class="mb-8"><h1 class="text-3xl font-bold text-gray-900 dark:text-white flex items-center"><svg class="h-8 w-8 mr-3 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> åˆ›å»ºèµ„æº </h1><p class="text-gray-600 dark:text-gray-400 mt-2">åˆ†äº«ä½ çš„å­¦ä¹ èµ„æºï¼Œå¸®åŠ©æ›´å¤šäººæˆé•¿</p></div>',1)),t("div",E,[t("div",M,[t("form",{onSubmit:S(f,["prevent"])},[t("div",R,[e[16]||(e[16]=t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-6 flex items-center"},[t("svg",{class:"h-5 w-5 mr-2 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),n(" åŸºæœ¬ä¿¡æ¯ ")],-1)),t("div",j,[t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[n(" èµ„æºæ ‡é¢˜ * "),t("span",{class:"text-xs text-gray-500 dark:text-gray-400 ml-2"},"(æè¿°é€‰å¡«)")],-1)),a(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.title=o),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"è¾“å…¥èµ„æºæ ‡é¢˜"},null,512),[[i,r.title]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," èµ„æºç±»å‹ * ",-1)),a(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.type=o),required:"",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"},[...e[9]||(e[9]=[b('<option value="">è¯·é€‰æ‹©</option><option value="video">è§†é¢‘è¯¾ç¨‹</option><option value="article">æ–‡ç« æ•™ç¨‹</option><option value="book">ç”µå­ä¹¦ç±</option><option value="course">åœ¨çº¿è¯¾ç¨‹</option><option value="tool">å­¦ä¹ å·¥å…·</option><option value="other">å…¶ä»–</option>',7)])],512),[[m,r.type]])])]),t("div",A,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," èµ„æºæè¿° ",-1)),a(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=o=>r.description=o),rows:"4",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"è¯¦ç»†æè¿°ä½ çš„å­¦ä¹ èµ„æºå†…å®¹ï¼ˆé€‰å¡«ï¼‰..."},null,512),[[i,r.description]])]),t("div",I,[t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," å­¦ä¹ æ—¶é•¿ ",-1)),a(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>r.duration=o),type:"text",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"ä¾‹å¦‚ï¼š2å°æ—¶"},null,512),[[i,r.duration]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," éš¾åº¦ç­‰çº§ ",-1)),a(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>r.difficulty=o),class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"},[...e[13]||(e[13]=[t("option",{value:"beginner"},"åˆçº§",-1),t("option",{value:"intermediate"},"ä¸­çº§",-1),t("option",{value:"advanced"},"é«˜çº§",-1)])],512),[[m,r.difficulty]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," èµ„æºæ ‡ç­¾ ",-1)),a(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>r.tags=o),type:"text",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"ç”¨é€—å·åˆ†éš”ï¼Œå¦‚ï¼šå‰ç«¯,React,JavaScript"},null,512),[[i,r.tags]])])])]),t("div",N,[e[19]||(e[19]=t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-6 flex items-center"},[t("svg",{class:"h-5 w-5 mr-2 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})]),n(" é“¾æ¥ä¿¡æ¯ ")],-1)),t("div",q,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," èµ„æºé“¾æ¥ * ",-1)),a(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>r.url=o),type:"url",required:"",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"https://example.com/resource"},null,512),[[i,r.url]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," æä¾›è€… ",-1)),a(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>r.provider=o),type:"text",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"ä¸ªäººæˆ–æœºæ„åç§°"},null,512),[[i,r.provider]])])])]),t("div",z,[t("button",{type:"button",onClick:k,class:"px-6 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-colors"}," å–æ¶ˆ "),t("button",{type:"submit",disabled:d.value,class:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center disabled:opacity-50"},[d.value?(y(),c("svg",H,[...e[20]||(e[20]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):V("",!0),n(" "+U(d.value?"æäº¤ä¸­...":"å‘å¸ƒèµ„æº"),1)],8,F)])],32)])])]))}}),T=B(J,[["__file","E:/å‰ç«¯åˆçº§è¯¾ç¨‹/program/EduMatch/src/views/CreateResource.vue"]]);export{T as default};
