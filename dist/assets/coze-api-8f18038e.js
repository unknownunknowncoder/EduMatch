var f=Object.defineProperty;var m=(d,t,e)=>t in d?f(d,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[t]=e;var h=(d,t,e)=>(m(d,typeof t!="symbol"?t+"":t,e),e);import{c as u}from"./index-0e60331d.js";/**
 * @license lucide-vue-next v0.420.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=u("SparklesIcon",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);class p{constructor(){h(this,"apiToken");h(this,"botId");this.apiToken="sat_uvUYKEkkKh2rL1IfHmO8IkVGwmdyZBP5D7PoxYuw1PvpMFhjMGy5GQyRiz2lBrlH",this.botId="7573579561607331840",console.log("Coze APIé…ç½®:",{hasToken:!!this.apiToken,hasBotId:!!this.botId,note:"é€šè¿‡ä»£ç†æœåŠ¡å™¨è°ƒç”¨æ‰£å­API"})}getUserId(){let t=localStorage.getItem("coze_user_id");return t||(t="user_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),localStorage.setItem("coze_user_id",t)),t}async searchResources(t){console.log("ğŸ” é€šè¿‡ä»£ç†æœåŠ¡å™¨æœç´¢æ‰£å­API:",t);const e=await fetch("http://localhost:3003/api/coze/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t.query})});if(e.ok){const n=await e.json();if(n.success&&n.data)return this.parseCozeResponse(n.data);throw new Error(n.error||"APIè°ƒç”¨å¤±è´¥")}else throw new Error(`ä»£ç†æœåŠ¡å™¨é”™è¯¯: ${e.status}`)}async searchRecommendations(t){console.log("ğŸ” é€šè¿‡ä»£ç†æœåŠ¡å™¨æœç´¢æ‰£å­API:",t);const e=await fetch("http://localhost:3003/api/coze/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t.query})});if(e.ok){const n=await e.json();if(n.success&&n.data)return this.parseCozeResponse(n.data);throw new Error(n.error||"APIè°ƒç”¨å¤±è´¥")}else throw new Error(`ä»£ç†æœåŠ¡å™¨é”™è¯¯: ${e.status}`)}parseCozeResponse(t){console.log("ğŸ” è§£ææ‰£å­APIå“åº”:",t);let e="";if(typeof t=="string")try{t=JSON.parse(t)}catch{console.log("ğŸ“ ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²å†…å®¹"),e=t}if(t.data&&t.data.length>0){const n=t.data.filter(o=>o.role==="assistant"&&o.type==="answer");n.length>0&&(e=n[n.length-1].content||"")}else if(t.messages&&t.messages.length>0){const n=t.messages.filter(o=>o.role==="assistant"&&o.type==="answer"&&o.content_type==="text"&&o.content&&o.content.includes("ğŸ¯"));if(n.length>0)e=n[n.length-1].content||"";else{const o=t.messages.filter(a=>a.role==="assistant"&&a.type==="answer"&&a.content_type==="text");o.length>0&&(e=o[o.length-1].content||"")}}else t.content?e=t.content:!e&&typeof t=="object"&&(e=JSON.stringify(t));if(console.log("ğŸ“ æå–çš„å†…å®¹:",e),!e)throw new Error("æ— æ³•ä»APIå“åº”ä¸­æå–å†…å®¹");return this.parseRecommendations(e)}parseRecommendations(t){console.log("ğŸ” è§£ææ¨èå†…å®¹:",t);const e={top_recommendation:{name:"",platform:"Bç«™",reason:"æš‚æ— æ¨è",duration:"å¾…ç¡®è®¤",study_data:"æš‚æ— æ•°æ®"},other_recommendations:[],learning_advice:"å»ºè®®ç»“åˆç†è®ºå­¦ä¹ å’Œå®é™…æ“ä½œï¼Œåˆ¶å®šåˆç†çš„å­¦ä¹ è®¡åˆ’ã€‚"};try{const n=t.split(`
`).map(l=>l.trim());let o="",a={};for(let l=0;l<n.length;l++){const c=n[l];if(c.includes("ğŸ¯")&&c.includes("æœ€æ¨è")){o="top";const i=c.match(/ğŸ¯\s*\*?\*?æœ€æ¨è\*?\*?[ï¼š:]\s*(.+)/);i&&(e.top_recommendation.name=i[1].trim())}else if(c.includes("ğŸ“š")&&c.includes("å…¶ä»–æ¨è"))o="others";else if(c.includes("ğŸ’¡")&&c.includes("å­¦ä¹ å»ºè®®")){o="advice";const i=c.match(/ğŸ’¡\s*\*?\*?å­¦ä¹ å»ºè®®\*?\*?[ï¼š:]\s*(.+)/);i&&(e.learning_advice=i[1].trim())}else if(c.startsWith("-")||c.startsWith("â€¢")){const i=c.replace(/^[-â€¢*]\s*/,"");if(i.includes("**å¹³å°æ¥æº**")){const r=i.match(/\*\*å¹³å°æ¥æº\*\*[ï¼š:]\s*(.+)/);if(r){const s=r[1].trim();o==="top"?e.top_recommendation.platform=s.includes("MOOC")?"ä¸­å›½å¤§å­¦MOOCå®˜ç½‘":"Bç«™":o==="others"&&a&&(a.platform=s.includes("MOOC")?"ä¸­å›½å¤§å­¦MOOCå®˜ç½‘":"Bç«™")}}else if(i.includes("**UPä¸»**")){const r=i.match(/\*\*UPä¸»\*\*[ï¼š:]\s*(.+)/);if(r){const s=r[1].trim();o==="top"?e.top_recommendation.up_host=s!=="æ— "?s:void 0:o==="others"&&a&&(a.up_host=s!=="æ— "?s:void 0)}}else if(i.includes("**æ¨èç†ç”±**")){const r=i.match(/\*\*æ¨èç†ç”±\*\*[ï¼š:]\s*(.+)/);if(r){const s=r[1].trim();o==="top"?e.top_recommendation.reason=s:o==="others"&&a&&(a.reason=s)}}else if(i.includes("**éš¾åº¦ç­‰çº§**")){const r=i.match(/\*\*éš¾åº¦ç­‰çº§\*\*[ï¼š:]\s*(.+)/);if(r){const s=r[1].trim();["å…¥é—¨","è¿›é˜¶","é«˜çº§"].includes(s)&&(o==="top"?e.top_recommendation.difficulty=s:o==="others"&&a&&(a.difficulty=s))}}else if(i.includes("**å­¦ä¹ æ—¶é•¿**")){const r=i.match(/\*\*å­¦ä¹ æ—¶é•¿\*\*[ï¼š:]\s*(.+)/);if(r){const s=r[1].trim();o==="top"?e.top_recommendation.duration=s:o==="others"&&a&&(a.duration=s)}}else if(i.includes("**å­¦ä¹ æ•°æ®**")){const r=i.match(/\*\*å­¦ä¹ æ•°æ®\*\*[ï¼š:]\s*(.+)/);if(r){const s=r[1].trim();o==="top"?e.top_recommendation.study_data=s:o==="others"&&a&&(a.study_data=s)}}else if(i.includes("**Bç«™BVå·**")){const r=i.match(/\*\*Bç«™BVå·\*\*[ï¼š:]\s*(.+)/);if(r){const s=r[1].trim();s&&s!=="æ— "&&(o==="top"?e.top_recommendation.bv_number=s:o==="others"&&a&&(a.bv_number=s))}}else if(i.includes("**æœºæ„**")){const r=i.match(/\*\*æœºæ„\*\*[ï¼š:]\s*(.+)/);if(r){const s=r[1].trim();o==="top"?e.top_recommendation.institution=s:o==="others"&&a&&(a.institution=s)}}}else if(/^\d+\./.test(c)&&o==="others"){const i=c.match(/^\d+\.\s*\*?\*?([^*]+)\*?\*?/);i&&(Object.keys(a).length>0&&e.other_recommendations.push({...a}),a={name:i[1].trim(),platform:"Bç«™",difficulty:"å…¥é—¨",duration:"å¾…ç¡®è®¤",study_data:"æ¨è",reason:"æ™ºèƒ½æ¨èèµ„æº"})}if(o==="others"&&Object.keys(a).length>0&&c.trim()){const i=n.slice(l+1,Math.min(l+8,n.length));for(let r=0;r<i.length;r++){const s=i[r].trim();if(!((s.startsWith("-")||s.startsWith("â€¢"))&&(s.includes("**å¹³å°æ¥æº**")||s.includes("**Bç«™BVå·**")||s.includes("**å­¦ä¹ æ•°æ®**")||s.includes("**å­¦ä¹ æ—¶é•¿**")||s.includes("**æœºæ„**")||s.includes("**UPä¸»**")))&&(/^\d+\./.test(s)||s.includes("ğŸ“š")||s.includes("ğŸ’¡")))break}}}if(Object.keys(a).length>0&&e.other_recommendations.push({...a}),!e.top_recommendation.name){const l=n.find(c=>c.length>10&&!c.includes("ğŸ¯")&&!c.includes("ğŸ“š")&&!c.includes("ğŸ’¡"));l&&(e.top_recommendation.name=l.substring(0,100).trim())}e.top_recommendation.reason||(e.top_recommendation.reason="AIæ™ºèƒ½æ¨èçš„å­¦ä¹ èµ„æº")}catch(n){throw console.error("âŒ è§£ææ¨èå†…å®¹å¤±è´¥:",n),new Error(`è§£ææ¨èå†…å®¹å¤±è´¥: ${n.message}`)}return console.log("âœ… æœ€ç»ˆè§£æç»“æœ:",e),e}getConfigStatus(){const t=[];return this.apiToken||t.push("API Token"),this.botId||t.push("Bot ID"),{configured:t.length===0,missing:t}}}const M=new p;export{_ as S,M as c};
