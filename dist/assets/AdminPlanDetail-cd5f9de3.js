import{d as R,D as F,s as V,r as _,A as P,o as $,b as o,e as n,u as c,n as q,f as e,t as a,g as x,F as f,j as b,G as H,z as S,_ as O}from"./index-0e60331d.js";import{s as G,g as J,m as B,a as K,b as Q,c as W}from"./message-2c75333d.js";const X={class:"min-h-screen bg-gray-50"},Y=["innerHTML"],Z={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},ee={key:0,class:"text-center py-16"},te={key:1,class:"text-center py-16"},se={class:"text-gray-600 mb-8"},le={key:2,class:"fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-pulse"},ae={key:3,class:"space-y-8"},oe={class:"bg-white rounded-lg shadow p-6"},ne={class:"text-2xl font-bold text-gray-900 mb-4"},re={class:"flex items-center justify-between mb-6"},ie={class:"flex items-center space-x-4"},de={class:"flex items-center"},ue={class:"h-10 w-10 rounded-full bg-purple-500 flex items-center justify-center text-white font-bold"},ce={class:"ml-3"},xe={class:"text-sm font-medium text-gray-900"},ge={class:"text-xs text-gray-500"},_e={class:"text-sm text-gray-500"},me={class:"flex items-center space-x-4"},ve={class:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm"},pe={class:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm"},he={key:0,class:"prose max-w-none mb-6"},ye={class:"whitespace-pre-wrap text-gray-700"},fe={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},be={class:"text-gray-700"},we={class:"text-gray-700"},ke={key:1},De={class:"list-disc list-inside space-y-2 text-gray-700"},Te={class:"bg-white rounded-lg shadow p-6"},Ae={class:"space-y-4"},Ie={class:"flex justify-between items-center mb-2"},Ce={class:"text-sm font-bold text-blue-600"},Ee={class:"w-full bg-gray-200 rounded-full h-3"},Pe={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Se={class:"text-center"},Be={class:"text-2xl font-bold text-blue-600"},je={class:"text-center"},Le={class:"text-2xl font-bold text-green-600"},Me={class:"text-center"},ze={class:"text-2xl font-bold text-orange-600"},Ue={key:0,class:"bg-white rounded-lg shadow p-6"},Ne={class:"space-y-4"},Re={class:"flex justify-between items-start"},Fe={class:"flex-1"},Ve={class:"font-medium text-gray-900"},$e={class:"text-sm text-gray-600 mt-1"},qe={class:"flex items-center space-x-4 mt-2"},He={class:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs"},Oe=["href"],Ge={class:"bg-white rounded-lg shadow p-6"},Je={key:0,class:"text-center py-8 text-gray-500"},Ke={key:1,class:"space-y-3"},Qe={class:"text-sm font-medium text-gray-900"},We={class:"text-xs text-gray-500"},Xe=R({__name:"AdminPlanDetail",setup(Ye){const w=F(),u=V(),p=w.params.id,k=w.query.user_id||null,h=_(!0),g=_(""),s=_(null),m=_([]),D=_(!1),j=P(()=>m.value.filter(l=>l.created_at).length),L=P(()=>{var l,t;return((t=(l=s.value)==null?void 0:l.resources)==null?void 0:t.length)||0}),y=l=>new Date(l).toLocaleString("zh-CN"),T=l=>new Date(l).toLocaleDateString("zh-CN"),M=l=>{switch(l){case"active":return"è¿›è¡Œä¸­";case"completed":return"å·²å®Œæˆ";case"paused":return"å·²æš‚åœ";case"cancelled":return"å·²å–æ¶ˆ";default:return"æœªçŸ¥çŠ¶æ€"}},z=l=>{switch(l){case"beginner":return"åˆçº§";case"intermediate":return"ä¸­çº§";case"advanced":return"é«˜çº§";case"expert":return"ä¸“å®¶çº§";default:return"æœªè®¾ç½®"}},A=async()=>{h.value=!0,g.value="";try{console.log("ğŸ”„ åŠ è½½ç®¡ç†å‘˜å­¦ä¹ è®¡åˆ’è¯¦æƒ…ï¼ŒID:",p);const{supabaseService:l}=await S(()=>import("./supabase-b4265a88.js"),["assets/supabase-b4265a88.js","assets/index-0e60331d.js","assets/index-3cf0edb8.css"]),t=await l.getStudyPlanById(p);if(!t){g.value="å­¦ä¹ è®¡åˆ’ä¸å­˜åœ¨æˆ–å·²è¢«åˆ é™¤";return}let i=null;if(t.user_id)try{i=await l.getUserById(t.user_id)}catch(v){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",v)}const{data:d}=await l.getClient().from("study_plan_checkins").select("*").eq("plan_id",p).order("created_at",{ascending:!1});s.value={...t,user:i},m.value=d||[],console.log("âœ… å­¦ä¹ è®¡åˆ’è¯¦æƒ…åŠ è½½æˆåŠŸ:",s.value)}catch(l){console.error("âŒ åŠ è½½å­¦ä¹ è®¡åˆ’è¯¦æƒ…å¤±è´¥:",l),g.value="åŠ è½½å­¦ä¹ è®¡åˆ’è¯¦æƒ…å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•"}finally{h.value=!1}},U=()=>{var l,t;console.log("ğŸ”™ ç‚¹å‡»è¿”å›æŒ‰é’®");try{const i=((l=s.value)==null?void 0:l.user_id)||k;if(i){const d=`/admin/user/${i}`;console.log("ğŸ“ è¿”å›åˆ°ç”¨æˆ·è¯¦æƒ…é¡µé¢:",d),console.log("ğŸ“ ä½¿ç”¨ç”¨æˆ·ID:",i,"(æ¥è‡ªè®¡åˆ’:",!!((t=s.value)!=null&&t.user_id),", æ¥è‡ªURL:",!!k,")"),u.push(d);return}window.history.length>1?(console.log("ğŸ“ ä½¿ç”¨ history.back() è¿”å›"),u.back()):(console.log("ğŸ“ è·³è½¬åˆ°ç®¡ç†ä¸»é¡µ"),u.push("/admin"))}catch(i){console.error("âŒ è¿”å›å¤±è´¥ï¼Œè·³è½¬åˆ°ç®¡ç†é¡µé¢:",i),u.push("/admin")}},N=async()=>{if(s.value&&confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå­¦ä¹ è®¡åˆ’å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚"))try{console.log("ğŸ—‘ï¸ åˆ é™¤å­¦ä¹ è®¡åˆ’ï¼ŒID:",s.value.id);const{supabaseService:l}=await S(()=>import("./supabase-b4265a88.js"),["assets/supabase-b4265a88.js","assets/index-0e60331d.js","assets/index-3cf0edb8.css"]);await l.deleteStudyPlan(s.value.id),console.log("âœ… å­¦ä¹ è®¡åˆ’åˆ é™¤æˆåŠŸ"),D.value=!0,W("å­¦ä¹ è®¡åˆ’åˆ é™¤æˆåŠŸï¼","success"),setTimeout(()=>{if(s.value.user_id){const t=`/admin/user/${s.value.user_id}`;console.log("ğŸ—‘ï¸ åˆ é™¤æˆåŠŸï¼Œè¿”å›åˆ°ç”¨æˆ·è¯¦æƒ…é¡µé¢:",t),u.push(t)}else console.log("ğŸ—‘ï¸ åˆ é™¤æˆåŠŸï¼Œè¿”å›åˆ°ç®¡ç†ä¸»é¡µ"),u.push("/admin")},1500)}catch(l){console.error("âŒ åˆ é™¤å­¦ä¹ è®¡åˆ’å¤±è´¥:",l),showNotification("åˆ é™¤å­¦ä¹ è®¡åˆ’å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•","error")}};return $(()=>{A()}),(l,t)=>{var i,d,v,I,C,E;return o(),n("div",X,[c(G)?(o(),n("div",{key:0,class:q([c(J)(c(B)),"flex items-center space-x-2"])},[e("span",{innerHTML:c(K)(c(B))},null,8,Y),e("span",null,a(c(Q)),1)],2)):x("",!0),e("header",{class:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50"},[e("div",{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},[e("div",{class:"flex justify-between items-center h-16"},[e("div",{class:"flex items-center"},[e("button",{onClick:U,class:"mr-4 text-gray-600 hover:text-gray-900"},[...t[0]||(t[0]=[e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),t[1]||(t[1]=e("h1",{class:"text-xl font-bold text-gray-900"},"å­¦ä¹ è®¡åˆ’è¯¦æƒ…ç®¡ç†",-1))]),e("div",{class:"flex items-center"},[e("button",{onClick:N,class:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors"}," åˆ é™¤è®¡åˆ’ ")])])])]),e("main",Z,[h.value?(o(),n("div",ee,[...t[2]||(t[2]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"},null,-1),e("p",{class:"text-gray-600"},"æ­£åœ¨åŠ è½½å­¦ä¹ è®¡åˆ’è¯¦æƒ…...",-1)])])):g.value?(o(),n("div",te,[t[3]||(t[3]=e("div",{class:"text-red-600 text-6xl mb-4"},"âŒ",-1)),t[4]||(t[4]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-4"},"åŠ è½½å¤±è´¥",-1)),e("p",se,a(g.value),1),e("button",{onClick:A,class:"px-6 py-3 bg-blue-600 text-white rounded hover:bg-blue-700"}," é‡æ–°åŠ è½½ ")])):x("",!0),D.value?(o(),n("div",le," âœ… å­¦ä¹ è®¡åˆ’åˆ é™¤æˆåŠŸ ")):s.value?(o(),n("div",ae,[e("div",oe,[e("h2",ne,a(s.value.title),1),e("div",re,[e("div",ie,[e("div",de,[e("div",ue,a(((d=(i=s.value.user)==null?void 0:i.nickname)==null?void 0:d.charAt(0))||((I=(v=s.value.user)==null?void 0:v.username)==null?void 0:I.charAt(0))||"U"),1),e("div",ce,[e("p",xe,a(((C=s.value.user)==null?void 0:C.nickname)||((E=s.value.user)==null?void 0:E.username)||"æœªçŸ¥ç”¨æˆ·"),1),e("p",ge,a(s.value.user_id),1)])]),e("div",_e,[e("span",null,"åˆ›å»ºæ—¶é—´ï¼š"+a(y(s.value.created_at)),1),t[5]||(t[5]=e("span",{class:"mx-2"},"|",-1)),e("span",null,"æœ€åæ›´æ–°ï¼š"+a(y(s.value.updated_at)),1)])]),e("div",me,[e("span",ve,a(M(s.value.status)),1),e("span",pe,a(z(s.value.difficulty)),1)])]),s.value.description?(o(),n("div",he,[e("div",ye,a(s.value.description),1)])):x("",!0),e("div",fe,[e("div",null,[t[6]||(t[6]=e("h4",{class:"text-sm font-medium text-gray-900 mb-2"},"å¼€å§‹æ—¶é—´",-1)),e("p",be,a(T(s.value.start_date)),1)]),e("div",null,[t[7]||(t[7]=e("h4",{class:"text-sm font-medium text-gray-900 mb-2"},"ç»“æŸæ—¶é—´",-1)),e("p",we,a(T(s.value.end_date)),1)])]),s.value.goals&&s.value.goals.length>0?(o(),n("div",ke,[t[8]||(t[8]=e("h4",{class:"text-sm font-medium text-gray-900 mb-3"},"å­¦ä¹ ç›®æ ‡",-1)),e("ul",De,[(o(!0),n(f,null,b(s.value.goals,r=>(o(),n("li",{key:r},a(r),1))),128))])])):x("",!0)]),e("div",Te,[t[13]||(t[13]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"è¿›åº¦ç»Ÿè®¡",-1)),e("div",Ae,[e("div",null,[e("div",Ie,[t[9]||(t[9]=e("span",{class:"text-sm font-medium text-gray-700"},"å®Œæˆè¿›åº¦",-1)),e("span",Ce,a(s.value.progress||0)+"%",1)]),e("div",Ee,[e("div",{class:"bg-blue-600 h-3 rounded-full transition-all duration-300",style:H({width:`${s.value.progress||0}%`})},null,4)])]),e("div",Pe,[e("div",Se,[e("div",Be,a(s.value.total_hours||0),1),t[10]||(t[10]=e("div",{class:"text-sm text-gray-600"},"æ€»å­¦æ—¶(å°æ—¶)",-1))]),e("div",je,[e("div",Le,a(j.value),1),t[11]||(t[11]=e("div",{class:"text-sm text-gray-600"},"å·²å®Œæˆä»»åŠ¡",-1))]),e("div",Me,[e("div",ze,a(L.value),1),t[12]||(t[12]=e("div",{class:"text-sm text-gray-600"},"æ€»ä»»åŠ¡æ•°",-1))])])])]),s.value.resources&&s.value.resources.length>0?(o(),n("div",Ue,[t[14]||(t[14]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"ç›¸å…³èµ„æº",-1)),e("div",Ne,[(o(!0),n(f,null,b(s.value.resources,r=>(o(),n("div",{key:r.id,class:"border border-gray-200 rounded-lg p-4"},[e("div",Re,[e("div",Fe,[e("h4",Ve,a(r.title),1),e("p",$e,a(r.description),1),e("div",qe,[e("span",He,a(r.type||"æ–‡æ¡£"),1),e("a",{href:r.url,target:"_blank",class:"text-blue-600 hover:text-blue-800 text-sm"}," æŸ¥çœ‹èµ„æº ",8,Oe)])])])]))),128))])])):x("",!0),e("div",Ge,[t[16]||(t[16]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"ç­¾åˆ°è®°å½•",-1)),m.value.length===0?(o(),n("div",Je," æš‚æ— ç­¾åˆ°è®°å½• ")):(o(),n("div",Ke,[(o(!0),n(f,null,b(m.value,r=>(o(),n("div",{key:r.id,class:"flex justify-between items-center p-3 border border-gray-200 rounded"},[e("div",null,[e("p",Qe,a(y(r.created_at)),1),e("p",We,a(r.notes||"æ— å¤‡æ³¨"),1)]),t[15]||(t[15]=e("span",{class:"px-2 py-1 bg-green-100 text-green-800 rounded text-xs"}," å·²ç­¾åˆ° ",-1))]))),128))]))])])):x("",!0)])])}}});const tt=O(Xe,[["__file","E:/å‰ç«¯åˆçº§è¯¾ç¨‹/program/EduMatch/src/views/AdminPlanDetail.vue"]]);export{tt as default};
