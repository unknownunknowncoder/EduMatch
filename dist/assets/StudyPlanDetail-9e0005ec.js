import{d as M,D as z,s as S,r as k,A as x,o as P,b as l,e as n,n as f,t as r,g as d,f as t,p as u,F as V,j as E,G as A,i as L,z as b,_ as T}from"./index-0e60331d.js";const I={class:"p-6 md:p-8"},N={key:1,class:"max-w-4xl mx-auto"},$={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden"},H={class:"p-6 border-b border-gray-100 dark:border-gray-700"},F={class:"flex justify-between items-start mb-4"},R={class:"text-2xl font-bold text-gray-900 dark:text-white mb-2"},O={class:"flex items-center text-sm text-gray-600 dark:text-gray-400"},G={class:"flex items-center space-x-2"},q={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},J={class:"text-center"},K={class:"flex items-center justify-center mb-1"},Q={class:"ml-1 font-semibold text-lg"},U={class:"text-center"},W={class:"flex items-center justify-center mb-1"},X={class:"ml-1 font-semibold text-lg"},Y={class:"text-center"},Z={class:"flex items-center justify-center mb-1"},tt={class:"ml-1 font-semibold text-lg"},et={class:"text-center"},st={class:"flex items-center justify-center mb-1"},ot={class:"ml-1 font-semibold text-lg"},rt={class:"p-6"},at={class:"mb-6"},lt={class:"text-gray-700 dark:text-gray-300 leading-relaxed"},nt={key:0,class:"mb-6"},it={class:"space-y-2"},dt={class:"text-gray-700 dark:text-gray-300"},ut={class:"mb-6"},ct={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4"},gt={class:"text-sm text-gray-600 dark:text-gray-400 mt-2"},xt={class:"flex flex-col sm:flex-row gap-4 pt-6 border-t border-gray-100 dark:border-gray-700"},vt={key:2,class:"text-center py-16"},mt=M({__name:"StudyPlanDetail",setup(pt){const w=z(),v=S(),s=k(null),i=k({show:!1,message:"",type:"success"}),m=(o,e="success")=>{i.value={show:!0,message:o,type:e},setTimeout(()=>{i.value.show=!1},3e3)},c=x(()=>{var o;return(o=s.value)!=null&&o.checkins?s.value.checkins.reduce((e,a)=>e+a.hours,0):0}),p=x(()=>{var o;return!((o=s.value)!=null&&o.total_hours)||s.value.total_hours===0?0:Math.round(c.value/s.value.total_hours*100)}),_=x(()=>{var y;if(!((y=s.value)!=null&&y.target_date))return 0;const o=new Date(s.value.target_date),e=new Date,a=o.getTime()-e.getTime(),g=Math.ceil(a/(1e3*60*60*24));return Math.max(0,g)}),h=o=>new Date(o).toLocaleDateString("zh-CN"),C=async o=>{try{const{supabaseService:e}=await b(()=>import("./supabase-b4265a88.js"),["assets/supabase-b4265a88.js","assets/index-0e60331d.js","assets/index-3cf0edb8.css"]),a=await e.getStudyPlanById(o);a?s.value={...a,total_hours:a.total_hours||0,goals:a.goals||[],checkins:a.checkins||[]}:console.error("计划未找到:",o)}catch(e){console.error("加载计划失败:",e)}},D=()=>{var o;v.push(`/study-plan/${(o=s.value)==null?void 0:o.id}/checkin`)},j=async()=>{if(s.value)try{const{supabaseService:o}=await b(()=>import("./supabase-b4265a88.js"),["assets/supabase-b4265a88.js","assets/index-0e60331d.js","assets/index-3cf0edb8.css"]);await o.updateStudyPlan(s.value.id,{status:"completed",completed_at:new Date().toISOString()}),s.value&&(s.value.status="completed"),m("计划已标记为完成！","success")}catch(o){console.error("完成计划失败:",o),m("操作失败，请稍后重试","error")}},B=()=>{var o;v.push(`/study-plan/${(o=s.value)==null?void 0:o.id}/edit`)};return P(()=>{const o=w.params.id;C(o)}),(o,e)=>(l(),n("div",I,[i.value.show?(l(),n("div",{key:0,class:f(["fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 animate-pulse",i.value.type==="success"?"bg-green-600 text-white":i.value.type==="error"?"bg-red-600 text-white":"bg-blue-600 text-white"])},r(i.value.type==="success"?"✅":i.value.type==="error"?"❌":"ℹ️")+" "+r(i.value.message),3)):d("",!0),t("button",{onClick:e[0]||(e[0]=a=>o.$router.back()),class:"mb-6 flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors"},[...e[1]||(e[1]=[t("svg",{class:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),u(" 返回学习计划 ",-1)])]),s.value?(l(),n("div",N,[t("div",$,[t("div",H,[t("div",F,[t("div",null,[t("h1",R,r(s.value.title),1),t("div",O,[t("span",null,"创建时间："+r(h(s.value.created_at)),1),e[2]||(e[2]=t("span",{class:"mx-2"},"•",-1)),t("span",null,"目标时间："+r(h(s.value.target_date)),1)])]),t("div",G,[t("span",{class:f(`px-3 py-1 rounded-full text-sm font-medium ${s.value.status==="in_progress"?"bg-blue-100 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400":"bg-green-100 dark:bg-green-900/20 text-green-600 dark:text-green-400"}`)},r(s.value.status==="in_progress"?"进行中":"已完成"),3)])]),t("div",q,[t("div",J,[t("div",K,[e[3]||(e[3]=t("svg",{class:"h-5 w-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",Q,r(s.value.total_hours||0),1)]),e[4]||(e[4]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"总学时(小时)",-1))]),t("div",U,[t("div",W,[e[5]||(e[5]=t("svg",{class:"h-5 w-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round",stroke:"joinround","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",X,r(c.value),1)]),e[6]||(e[6]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"已完成学时",-1))]),t("div",Y,[t("div",Z,[e[7]||(e[7]=t("svg",{class:"h-5 w-5 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)),t("span",tt,r(p.value)+"%",1)]),e[8]||(e[8]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"完成进度",-1))]),t("div",et,[t("div",st,[e[9]||(e[9]=t("svg",{class:"h-5 w-5 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),t("span",ot,r(_.value),1)]),e[10]||(e[10]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"剩余天数",-1))])])]),t("div",rt,[t("div",at,[e[11]||(e[11]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-3"},"计划描述",-1)),t("p",lt,r(s.value.description),1)]),s.value.goals&&s.value.goals.length>0?(l(),n("div",nt,[e[13]||(e[13]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-3"},"学习目标",-1)),t("ul",it,[(l(!0),n(V,null,E(s.value.goals,(a,g)=>(l(),n("li",{key:g,class:"flex items-start"},[e[12]||(e[12]=t("span",{class:"text-blue-500 mr-3 mt-1"},"•",-1)),t("span",dt,r(a),1)]))),128))])])):d("",!0),t("div",ut,[e[14]||(e[14]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-3"},"学习进度",-1)),t("div",ct,[t("div",{class:"bg-gradient-to-r from-blue-500 to-blue-600 h-4 rounded-full transition-all duration-300",style:A({width:`${p.value}%`})},null,4)]),t("p",gt," 已完成 "+r(c.value)+" / "+r(s.value.total_hours||0)+" 小时 ",1)]),t("div",xt,[s.value.status==="in_progress"?(l(),n("button",{key:0,onClick:D,class:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center justify-center"},[...e[15]||(e[15]=[t("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),u(" 学习打卡 ",-1)])])):d("",!0),s.value.status==="in_progress"?(l(),n("button",{key:1,onClick:j,class:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors flex items-center justify-center"},[...e[16]||(e[16]=[t("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),u(" 完成计划 ",-1)])])):d("",!0),t("button",{onClick:B,class:"px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors flex items-center justify-center"},[...e[17]||(e[17]=[t("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),u(" 编辑计划 ",-1)])])])])])])):(l(),n("div",vt,[...e[18]||(e[18]=[L('<svg class="animate-spin h-10 w-10 text-blue-500 mx-auto mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><h3 class="text-lg font-medium mb-2">正在加载计划信息</h3><p class="text-gray-500 dark:text-gray-400">请稍候...</p>',3)])]))]))}}),yt=T(mt,[["__file","E:/前端初级课程/program/EduMatch/src/views/StudyPlanDetail.vue"]]);export{yt as default};
