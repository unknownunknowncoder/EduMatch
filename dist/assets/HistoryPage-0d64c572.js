import{c as F,d as M,r as w,s as V,h as $,a,b as t,e as n,f as c,l as v,B as E,j as D,k as N,F as S,z as C,o as l,G as A,t as g,_ as L}from"./index-7612b546.js";import{C as b}from"./clock-aad734ed.js";import{D as O}from"./dollar-sign-a25cdb80.js";import{B as T}from"./book-open-0777e7bd.js";/**
 * @license lucide-vue-next v0.420.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=F("Trash2Icon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),K={class:"min-h-screen bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-100 p-6"},P={class:"mb-8 flex justify-between items-center"},U={class:"text-3xl font-bold text-gray-900 dark:text-white flex items-center"},J={key:0,class:"flex flex-col items-center justify-center py-16 text-center"},R={key:1},q={key:0,class:"bg-white dark:bg-gray-800 rounded-xl p-8 text-center shadow-md"},Q={class:"bg-gray-100 dark:bg-gray-700 p-4 rounded-full inline-flex items-center justify-center mb-4"},W={key:1,class:"space-y-6"},X={class:"px-6 py-3 bg-blue-50 dark:bg-blue-900/20 flex items-center"},Y={class:"font-medium text-blue-600 dark:text-blue-400"},Z={class:"divide-y divide-gray-100 dark:divide-gray-700"},G={class:"flex justify-between items-start"},ee={class:"flex-1 min-w-0"},te={class:"font-bold text-lg mb-1 line-clamp-1"},se={class:"flex items-center text-sm text-gray-500 dark:text-gray-400 mb-2"},re={class:"flex items-center"},oe={class:"grid grid-cols-3 gap-2 mb-3"},ae={class:"flex items-center"},ne={class:"bg-gray-100 dark:bg-gray-700 p-1.5 rounded-lg mr-1.5"},le={class:"text-xs"},ie={class:"flex items-center"},de={class:"text-xs"},ce={class:"flex items-center"},ue={class:"bg-gray-100 dark:bg-gray-700 p-1.5 rounded-lg mr-1.5"},ge={class:"text-xs"},ye=["onClick"],me=M({__name:"HistoryPage",setup(xe){const u=w([]),h=w(!0),_=()=>{const s=localStorage.getItem("currentUser");if(s)try{return JSON.parse(s).id.toString()}catch(e){console.error("Failed to parse current user:",e)}return"default_user"},I=()=>{h.value=!0;try{const e=`resource_history_${_()}`,y=localStorage.getItem(e);if(y)try{const o=JSON.parse(y);o.sort((i,m)=>m.timestamp-i.timestamp);const x={};o.forEach(i=>{const d=new Date(i.timestamp).toDateString();x[d]||(x[d]=[]),x[d].push(i)});const r=Object.entries(x).map(([i,m])=>{const d=new Date(i),k=new Date,f=new Date(k);f.setDate(f.getDate()-1);let p="";return d.toDateString()===k.toDateString()?p="今天":d.toDateString()===f.toDateString()?p="昨天":p=`${d.getMonth()+1}月${d.getDate()}日`,{date:i,dateLabel:p,items:m}});u.value=r}catch(o){console.error("Failed to parse history items:",o),u.value=[]}else u.value=[]}catch(s){console.error("Failed to load history:",s),u.value=[]}finally{h.value=!1}},B=()=>{try{const e=`resource_history_${_()}`;localStorage.removeItem(e),u.value=[],console.log("历史记录已清空")}catch(s){console.error("Failed to clear history:",s),console.error("清空历史记录失败")}},H=(s,e)=>{s.preventDefault(),window.open(e,"_blank","noopener,noreferrer")},j=s=>{const e=new Date(s),y=e.getHours().toString().padStart(2,"0"),o=e.getMinutes().toString().padStart(2,"0");return`${y}:${o}`};return V(()=>{I()}),(s,e)=>{const y=$("router-link");return l(),a("div",K,[t("div",P,[t("div",null,[t("h1",U,[n(c(b),{class:"h-8 w-8 mr-3 text-blue-500"}),e[0]||(e[0]=v(" 学习记录 ",-1))]),e[1]||(e[1]=t("p",{class:"text-gray-600 dark:text-gray-400 mt-2"},"查看你的学习足迹",-1))]),t("button",{onClick:B,class:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors flex items-center"},[n(c(z),{class:"h-4 w-4 mr-2"}),e[2]||(e[2]=v(" 清空历史 ",-1))])]),h.value?(l(),a("div",J,[...e[3]||(e[3]=[E('<svg class="animate-spin h-10 w-10 text-blue-500 mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><h3 class="text-lg font-medium mb-2">正在加载历史记录</h3><p class="text-gray-500 dark:text-gray-400">请稍候...</p>',3)])])):D("",!0),h.value?D("",!0):(l(),a("div",R,[u.value.length===0?(l(),a("div",q,[t("div",Q,[n(c(b),{class:"h-8 w-8 text-gray-400"})]),e[5]||(e[5]=t("h3",{class:"text-lg font-medium mb-2"},"暂无浏览记录",-1)),e[6]||(e[6]=t("p",{class:"text-gray-500 dark:text-gray-400 mb-6"},"浏览教育资源后，这里将显示你的学习足迹",-1)),n(y,{to:"/search",class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors inline-block"},{default:N(()=>[...e[4]||(e[4]=[v(" 去搜索资源 ",-1)])]),_:1})])):(l(),a("div",W,[(l(!0),a(S,null,C(u.value,(o,x)=>(l(),a("div",{key:o.date,class:"bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden transition-all duration-300"},[t("div",X,[n(c(A),{class:"h-4 w-4 text-blue-500 mr-2"}),t("span",Y,g(o.dateLabel),1)]),t("div",Z,[(l(!0),a(S,null,C(o.items,(r,i)=>(l(),a("div",{key:`${r.resource.id}_${r.timestamp}`,class:"p-4 hover:bg-gray-50 dark:hover:bg-gray-750 transition-all duration-300"},[t("div",G,[t("div",ee,[t("h3",te,g(r.resource.name),1),t("div",se,[t("span",null,g(r.resource.provider),1),e[7]||(e[7]=t("span",{class:"mx-2"},"•",-1)),t("span",re,[n(c(b),{class:"h-3 w-3 mr-1"}),v(" "+g(j(r.timestamp)),1)])]),t("div",oe,[t("div",ae,[t("div",ne,[n(c(b),{class:"h-3.5 w-3.5 text-gray-500 dark:text-gray-400"})]),t("div",le,g(r.resource.duration),1)]),t("div",ie,[e[8]||(e[8]=t("div",{class:"bg-gray-100 dark:bg-gray-700 p-1.5 rounded-lg mr-1.5"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"text-yellow-500"},[t("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})])],-1)),t("div",de,g(r.resource.rating)+"/10",1)]),t("div",ce,[t("div",ue,[n(c(O),{class:"h-3.5 w-3.5 text-green-500"})]),t("div",ge,g(r.resource.type),1)])])]),t("button",{onClick:m=>H(m,r.resource.url),class:"ml-3 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-all duration-200 hover:scale-105 active:scale-95 flex items-center"},[n(c(T),{class:"h-4 w-4 mr-1.5"}),e[9]||(e[9]=t("span",{class:"text-sm"},"继续学习",-1))],8,ye)])]))),128))])]))),128))]))]))])}}}),fe=L(me,[["__file","E:/前端初级课程/program/EduMatch/src/views/HistoryPage.vue"]]);export{fe as default};
