import{d as M,D as L,s as j,r as m,o as U,b as a,e as n,u as x,n as z,f as e,t as l,g as _,F as R,j as S,z as A,_ as q}from"./index-0e60331d.js";import{s as F,g as N,m as E,a as V,b as H,c as O}from"./message-2c75333d.js";const $={class:"min-h-screen bg-gray-50"},G=["innerHTML"],J={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},K={key:0,class:"text-center py-16"},Q={key:1,class:"text-center py-16"},W={class:"text-gray-600 mb-8"},X={key:2,class:"fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-pulse"},Y={key:3,class:"space-y-8"},Z={class:"bg-white rounded-lg shadow p-6"},ee={class:"text-2xl font-bold text-gray-900 mb-4"},te={class:"flex items-center justify-between mb-6"},se={class:"flex items-center space-x-4"},oe={class:"flex items-center"},le={class:"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold"},ae={class:"ml-3"},ne={class:"text-sm font-medium text-gray-900"},re={class:"text-xs text-gray-500"},ie={class:"text-sm text-gray-500"},de={class:"flex items-center space-x-4"},ce={key:0,class:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm"},ue={class:"prose max-w-none"},xe={key:0,class:"whitespace-pre-wrap text-gray-700"},_e={key:1,class:"text-gray-500 italic"},ge={class:"bg-white rounded-lg shadow p-6"},ve={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},me={class:"text-center"},pe={class:"text-3xl font-bold text-blue-600"},he={class:"text-center"},ye={class:"text-3xl font-bold text-green-600"},fe={class:"text-center"},be={class:"text-3xl font-bold text-orange-600"},we={key:0,class:"bg-white rounded-lg shadow p-6"},ke={class:"flex flex-wrap gap-2"},De={key:1,class:"bg-white rounded-lg shadow p-6"},Ce={class:"border border-gray-200 rounded-lg p-4"},Ie={class:"flex justify-between items-start"},Ae={class:"font-medium text-gray-900"},Ee={class:"text-sm text-gray-600 mt-1"},Pe={class:"flex items-center space-x-4 mt-2"},Te={class:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs"},Be=["href"],Me=M({__name:"AdminPostDetail",setup(Le){const y=L(),d=j(),g=y.params.id,f=y.query.user_id||null,h=m(!0),v=m(""),s=m(null),b=m(!1),w=m({show:!1,message:"",type:"success"}),P=(o,t="success")=>{w.value={show:!0,message:o,type:t},setTimeout(()=>{w.value.show=!1},3e3)},k=o=>new Date(o).toLocaleString("zh-CN"),D=async()=>{h.value=!0,v.value="";try{console.log("ğŸ”„ åŠ è½½ç®¡ç†å‘˜å¸–å­è¯¦æƒ…ï¼ŒID:",g);const{supabaseService:o}=await A(()=>import("./supabase-b4265a88.js"),["assets/supabase-b4265a88.js","assets/index-0e60331d.js","assets/index-3cf0edb8.css"]),t=await o.getPostById(g);if(!t){v.value="å¸–å­ä¸å­˜åœ¨æˆ–å·²è¢«åˆ é™¤";return}let r=null;if(t.user_id)try{r=await o.getUserById(t.user_id)}catch(p){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",p)}const{data:i}=await o.getClient().from("post_likes").select("id").eq("post_id",g),{data:c}=await o.getClient().from("post_comments").select("id").eq("post_id",g),{data:u}=await o.getClient().from("post_favorites").select("id").eq("post_id",g);s.value={...t,user:r,likes_count:(i==null?void 0:i.length)||0,comments_count:(c==null?void 0:c.length)||0,favorites_count:(u==null?void 0:u.length)||0,views_count:t.views_count||0},console.log("âœ… å¸–å­è¯¦æƒ…åŠ è½½æˆåŠŸ:",s.value)}catch(o){console.error("âŒ åŠ è½½å¸–å­è¯¦æƒ…å¤±è´¥:",o),v.value="åŠ è½½å¸–å­è¯¦æƒ…å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•"}finally{h.value=!1}},T=()=>{var o,t;console.log("ğŸ”™ ç‚¹å‡»è¿”å›æŒ‰é’®");try{const r=((o=s.value)==null?void 0:o.user_id)||f;if(r){const i=`/admin/user/${r}`;console.log("ğŸ“ è¿”å›åˆ°ç”¨æˆ·è¯¦æƒ…é¡µé¢:",i),console.log("ğŸ“ ä½¿ç”¨ç”¨æˆ·ID:",r,"(æ¥è‡ªå¸–å­:",!!((t=s.value)!=null&&t.user_id),", æ¥è‡ªURL:",!!f,")"),d.push(i);return}window.history.length>1?(console.log("ğŸ“ ä½¿ç”¨ history.back() è¿”å›"),d.back()):(console.log("ğŸ“ è·³è½¬åˆ°ç®¡ç†ä¸»é¡µ"),d.push("/admin"))}catch(r){console.error("âŒ è¿”å›å¤±è´¥ï¼Œè·³è½¬åˆ°ç®¡ç†é¡µé¢:",r),d.push("/admin")}},B=async()=>{if(s.value&&confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¸–å­å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚"))try{console.log("ğŸ—‘ï¸ åˆ é™¤å¸–å­ï¼ŒID:",s.value.id);const{supabaseService:o}=await A(()=>import("./supabase-b4265a88.js"),["assets/supabase-b4265a88.js","assets/index-0e60331d.js","assets/index-3cf0edb8.css"]);await o.deleteCommunityPost(s.value.id),console.log("âœ… å¸–å­åˆ é™¤æˆåŠŸ"),b.value=!0,O("å¸–å­åˆ é™¤æˆåŠŸï¼","success"),setTimeout(()=>{if(s.value.user_id){const t=`/admin/user/${s.value.user_id}`;console.log("ğŸ—‘ï¸ åˆ é™¤æˆåŠŸï¼Œè¿”å›åˆ°ç”¨æˆ·è¯¦æƒ…é¡µé¢:",t),d.push(t)}else console.log("ğŸ—‘ï¸ åˆ é™¤æˆåŠŸï¼Œè¿”å›åˆ°ç®¡ç†ä¸»é¡µ"),d.push("/admin")},1500)}catch(o){console.error("âŒ åˆ é™¤å¸–å­å¤±è´¥:",o),P("åˆ é™¤å¸–å­å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•","error")}};return U(()=>{D()}),(o,t)=>{var r,i,c,u,p,C;return a(),n("div",$,[x(F)?(a(),n("div",{key:0,class:z([x(N)(x(E)),"flex items-center space-x-2"])},[e("span",{innerHTML:x(V)(x(E))},null,8,G),e("span",null,l(x(H)),1)],2)):_("",!0),e("header",{class:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50"},[e("div",{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},[e("div",{class:"flex justify-between items-center h-16"},[e("div",{class:"flex items-center"},[e("button",{onClick:T,class:"mr-4 text-gray-600 hover:text-gray-900"},[...t[0]||(t[0]=[e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),t[1]||(t[1]=e("h1",{class:"text-xl font-bold text-gray-900"},"å¸–å­è¯¦æƒ…ç®¡ç†",-1))]),e("div",{class:"flex items-center"},[e("button",{onClick:B,class:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors"}," åˆ é™¤å¸–å­ ")])])])]),e("main",J,[h.value?(a(),n("div",K,[...t[2]||(t[2]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"},null,-1),e("p",{class:"text-gray-600"},"æ­£åœ¨åŠ è½½å¸–å­è¯¦æƒ…...",-1)])])):v.value?(a(),n("div",Q,[t[3]||(t[3]=e("div",{class:"text-red-600 text-6xl mb-4"},"âŒ",-1)),t[4]||(t[4]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-4"},"åŠ è½½å¤±è´¥",-1)),e("p",W,l(v.value),1),e("button",{onClick:D,class:"px-6 py-3 bg-blue-600 text-white rounded hover:bg-blue-700"}," é‡æ–°åŠ è½½ ")])):_("",!0),b.value?(a(),n("div",X," âœ… å¸–å­åˆ é™¤æˆåŠŸ ")):s.value?(a(),n("div",Y,[e("div",Z,[e("h2",ee,l(s.value.title),1),e("div",te,[e("div",se,[e("div",oe,[e("div",le,l(((i=(r=s.value.user)==null?void 0:r.nickname)==null?void 0:i.charAt(0))||((u=(c=s.value.user)==null?void 0:c.username)==null?void 0:u.charAt(0))||"U"),1),e("div",ae,[e("p",ne,l(((p=s.value.user)==null?void 0:p.nickname)||((C=s.value.user)==null?void 0:C.username)||"æœªçŸ¥ç”¨æˆ·"),1),e("p",re,l(s.value.user_id),1)])]),e("div",ie,[e("span",null,"å‘å¸ƒæ—¶é—´ï¼š"+l(k(s.value.created_at)),1),t[5]||(t[5]=e("span",{class:"mx-2"},"|",-1)),e("span",null,"æœ€åæ›´æ–°ï¼š"+l(k(s.value.updated_at)),1)])]),e("div",de,[s.value.category?(a(),n("span",ce,l(s.value.category),1)):_("",!0),t[6]||(t[6]=e("span",{class:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm"}," å·²å‘å¸ƒ ",-1))])]),e("div",ue,[s.value.content?(a(),n("div",xe,l(s.value.content),1)):(a(),n("div",_e," æ­¤å¸–å­æ²¡æœ‰å†…å®¹ "))])]),e("div",ge,[t[10]||(t[10]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"ç»Ÿè®¡ä¿¡æ¯",-1)),e("div",ve,[e("div",me,[e("div",pe,l(s.value.likes_count||0),1),t[7]||(t[7]=e("div",{class:"text-sm text-gray-600"},"ç‚¹èµæ•°",-1))]),e("div",he,[e("div",ye,l(s.value.comments_count||0),1),t[8]||(t[8]=e("div",{class:"text-sm text-gray-600"},"è¯„è®ºæ•°",-1))]),e("div",fe,[e("div",be,l(s.value.favorites_count||0),1),t[9]||(t[9]=e("div",{class:"text-sm text-gray-600"},"æ”¶è—æ•°",-1))])])]),s.value.tags&&s.value.tags.length>0?(a(),n("div",we,[t[11]||(t[11]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"æ ‡ç­¾",-1)),e("div",ke,[(a(!0),n(R,null,S(s.value.tags,I=>(a(),n("span",{key:I,class:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm"}," #"+l(I),1))),128))])])):_("",!0),s.value.resource?(a(),n("div",De,[t[12]||(t[12]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"ç›¸å…³èµ„æº",-1)),e("div",Ce,[e("div",Ie,[e("div",null,[e("h4",Ae,l(s.value.resource.title),1),e("p",Ee,l(s.value.resource.description),1),e("div",Pe,[e("span",Te,l(s.value.resource.category||"å…¶ä»–"),1),e("a",{href:s.value.resource.url,target:"_blank",class:"text-blue-600 hover:text-blue-800 text-sm"}," æŸ¥çœ‹èµ„æº ",8,Be)])])])])])):_("",!0)])):_("",!0)])])}}});const ze=q(Me,[["__file","E:/å‰ç«¯åˆçº§è¯¾ç¨‹/program/EduMatch/src/views/AdminPostDetail.vue"]]);export{ze as default};
